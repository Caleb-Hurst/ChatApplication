<!DOCTYPE html>
<html xmlns:th="http://thymeleaf.org">

<head>
<title>Chat</title>
<style>
/* Common styles for all devices */
html, body {
    background-image: linear-gradient(to right top, #a1a1a1, #81868c, #5c6f73, #3c5752, #2b3f2c);
    height: 100%;
    margin: 0; /* Set margin to 0 to avoid any default spacing */
    padding: 0; /* Set padding to 0 to avoid any default spacing */
}

.container {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    flex-direction: column;
}

h1 {
    text-align: center;
}

/* Style for the user's name display */
#username-display {
    position: absolute;
    top: 10px;
    right: 10px;
    color: white;
    font-size: 18px;
}

/* Mobile-specific styles */
@media (max-width: 768px) {
    h1 {
        font-size: 24px;
    }

    .form-label {
        font-size: 16px;
    }

    .form-control {
        font-size: 14px;
    }
}

</style>
</head>
<body>


	<h1>Channels</h1>
	<table class="table">
		<tbody>
			<tr th:each="channel: ${channels}">
			<td><a th:href="@{/channel/{channelId}(channelId=${channel.channelId})}" th:text="${channel.channelName}"></a>
		</tbody>

	</table>
	
	<form method="post" action="/">
		<div>
			<label class="form-label">New Channel: </label><input class="form-control" type="text" th:field="${channel.channelName}" />
		</div>
		<div>
			<input type="submit" value="Create"/>
		</div>
	</form>
	
	<script>// Check if the user's name is already stored in session storage
	let storedName = sessionStorage.getItem("username");

	if (storedName) {
		// User's name is already stored, use it
		var user = {
			"name": storedName
		};
		console.log(user);
		fetch(`/user?name=${user.name}`, {
			method: 'GET',
			headers: {
				'Content-Type': 'application/json'
			}
		}).then(response => response.json()).then(data => console.log(data));
	} else {
		// User's name is not stored, prompt for it
		let newName = prompt("Please enter your name:");
		var user = {
			"name": newName
		};
		console.log(user);
		fetch(`/user?name=${user.name}`, {
			method: 'GET',
			headers: {
				'Content-Type': 'application/json'
			}
		}).then(response => response.json()).then(data => console.log(data));

		// Store the user's name in session storage
		sessionStorage.setItem("username", newName);
	}


</script>
</body>
</html>
